___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Spindl Tag Template",
  "categories": [ "ANALYTICS" ],
  "brand": {
    "id": "brand_dummy",
    "displayName": "Custom Template",
    "thumbnail": "data:image/jpeg;base64,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\u003d\u003d"
  },
  "description": "Spindl Template for implementing SDK in GTM",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "RADIO",
    "name": "event_type",
    "displayName": "Event Type",
    "radioItems": [
      {
        "value": "custom",
        "displayValue": "Custom"
      },
      {
        "value": "wallet_connect",
        "displayValue": "Wallet Connect"
      }
    ],
    "simpleValueType": true
  },
  {
    "type": "TEXT",
    "name": "event_name",
    "displayName": "Event Name",
    "simpleValueType": true,
    "enablingConditions": [
      {
        "paramName": "event_type",
        "paramValue": "custom",
        "type": "EQUALS"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "group1",
    "displayName": "Additional Properties",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "SIMPLE_TABLE",
        "name": "properties",
        "displayName": "Optional: You can pass in additional properties here that you want to be passed in as params as part of custom event.",
        "simpleTableColumns": [
          {
            "defaultValue": "",
            "displayName": "Property Key",
            "name": "property_key",
            "type": "TEXT",
            "isUnique": true
          },
          {
            "defaultValue": "",
            "displayName": "Property Value",
            "name": "property_value",
            "type": "TEXT"
          }
        ],
        "enablingConditions": [],
        "valueValidators": []
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const log = require('logToConsole');
const callInWindow = require('callInWindow');


function arrayToObject(arr) {
  return (arr || []).reduce((obj, item) => {
    obj[item.property_key] = item.property_value;
    return obj;
  }, {});
}

log('data =', data);

const event_name = data.event_name;
const event_type = data.event_type;

 const params = arrayToObject(data.properties);
  log('params =', params);

if(event_type === 'custom') {

 callInWindow('spindl.track', event_name, params);

} else if (event_type === 'wallet_connect') {

  const wallet_address = data.wallet_address || '';
  callInWindow('spindl.attribute', wallet_address);

}


// Call data.gtmOnSuccess when the tag is finished.
data.gtmOnSuccess();


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "spindl.track"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "spindl.attribute"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 8/15/2024, 2:00:30 PM


